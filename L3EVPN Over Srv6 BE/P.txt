Step 1: Configure Interfaces
Description: This step configures the P router's interfaces. A Loopback interface is set up to provide a stable node identifier within the IGP. Physical interfaces are configured with IPv6 addresses to establish connections with the adjacent PE routers, forming the core network's data plane. 

JSON Example:

JSON

{
  "interfaces": {
    "Loopback1": {
      "description": "Stable node identifier for the P router",
      "ipv6_enable": true,
      "ipv6_address": {
        "address": "${loopback_ipv6_address}",
        "prefix_length": "${loopback_ipv6_prefix}"
      }
    },
    "${interface1_name}": {
      "description": "Interface connecting to the first PE",
      "ipv6_enable": true,
      "ipv6_address": {
        "address": "${interface1_ipv6_address}",
        "prefix_length": "${interface1_ipv6_prefix}"
      }
    },
    "${interface2_name}": {
      "description": "Interface connecting to the second PE",
      "ipv6_enable": true,
      "ipv6_address": {
        "address": "${interface2_ipv6_address}",
        "prefix_length": "${interface2_ipv6_prefix}"
      }
    }
  }
}
Step 2: Configure SRv6 Underlay SID
Description: This is a key step for the P router in a TE Policy scenario. The device must be configured with its own SRv6 locator and a static End SID. This SID serves as a "waypoint" or "transit segment" on the explicit path. The head-end PE router will include this P router's SID in its segment-list to force traffic to pass through this node. 


JSON Example:

JSON

{
  "segment_routing_v6": {
    "encapsulation_source_address": "${loopback_ipv6_address}",
    "locators": [
      {
        "name": "${locator_name}",
        "prefix": {
          "address": "${locator_prefix_address}",
          "prefix_length": "${locator_prefix_length}"
        },
        "static_sids": [
          {
            "opcode": "${end_sid_opcode}",
            "function": "end",
            "flavor": "psp"
          }
        ]
      }
    ]
  }
}
Step 3: Configure Underlay IGP (IS-IS) and Advertise SRv6
Description: IS-IS provides core network reachability. In this scenario, it must also be configured to advertise the SRv6 locator created in the previous step. The 

auto-sid-disable option is recommended to ensure that only the manually configured static SIDs are used, which is critical for the stability of a TE Policy. This makes the transit SID known to the PE routers so they can build their paths .



JSON Example:

JSON

{
  "routing": {
    "isis": {
      "process_id": "${isis_process_id}",
      "level": "level-1",
      "cost_style": "wide",
      "network_entity": "${net_entity}",
      "enabled_on_interfaces": [
        "${interface1_name}",
        "${interface2_name}",
        "Loopback1"
      ],
      "srv6_advertisement": {
        "locator": "${locator_name}",
        "auto_sid_disable": true
      }
    }
  }
}